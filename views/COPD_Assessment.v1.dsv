<!DOCTYPE html><html ng-app="cds_app">
<head>
<title>{{def.concept.name}}</title>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<link rel="stylesheet" type="text/css" href="wro/foundation.css"/>
<link rel="stylesheet" type="text/css" href="wro/date-picker.css"/>
<link rel="stylesheet" type="text/css" href="wro/angular.css"></link>
<script type="text/javascript" src="wro/angular.js"></script>
<link rel="text/javascript" type="text/css" href="wro/foundation.js"/>
<script type="text/javascript" src="wro/moment.js"></script>
<script type="text/javascript" src="wro/date-picker.js"></script>
<script type="text/javascript" src="wro/app_lib.js"></script>
<script id="decision-support-view" type="application/json">{
  "dsViewId": "COPD_Assessment.v1",
  "language": {
    "originalLanguage": {
      "terminologyId": {
        "name": "ISO_639-1",
        "value": "ISO_639-1"
      },
      "codeString": "en"
    }
  },
  "decisionSupportViewDefinitions": {
    "en": {
      "name": "Chronic Obstructive Pulmonary Disease Assessment"
    }
  },
  "resourceDescription": {
    "originalAuthor": {
      "organisation": "Cambio",
      "name": "MIG Students",
      "date": "2016-03-31"
    },
    "otherContributors": [],
    "lifecycleState": "Author draft",
    "details": {
      "en": {
        "keywords": [
          "copd",
          "cat"
        ]
      }
    },
    "otherDetails": {}
  },
  "alertGuideIds": [],
  "executionGuideIds": [
    "COPD_Assessment.v1"
  ],
  "alertBindings": {},
  "termDefinitions": {
    "en": {
      "id": "en",
      "terms": {}
    }
  }
}</script>
</head>
<body ng-controller="cds_controller">
<#assign copd_assessment_test_entry_ehr_data = "data.ehr['openEHR-EHR-OBSERVATION.copd_assessment_test.v1']">
<#assign copd_assessment_test_entry_cds_data = "data.cds['openEHR-EHR-OBSERVATION.copd_assessment_test.v1']">
<#assign copd_assessment_test_entry_def = "def.entries['openEHR-EHR-OBSERVATION.copd_assessment_test.v1']">
<#assign q5_def = copd_assessment_test_entry_def + ".elements['/data{at0001}/events{at0002}/data{at0003}/items{at0044}/items{at0045}']">
<#assign q7_def = copd_assessment_test_entry_def + ".elements['/data{at0001}/events{at0002}/data{at0003}/items{at0064}/items{at0065}']">
<#assign q6_def = copd_assessment_test_entry_def + ".elements['/data{at0001}/events{at0002}/data{at0003}/items{at0054}/items{at0055}']">
<#assign total_score_def = copd_assessment_test_entry_def + ".elements['/data{at0001}/events{at0002}/data{at0003}/items{at0085}']">
<#assign q1_def = copd_assessment_test_entry_def + ".elements['/data{at0001}/events{at0002}/data{at0003}/items{at0020}/items{at0004}']">
<#assign q4_def = copd_assessment_test_entry_def + ".elements['/data{at0001}/events{at0002}/data{at0003}/items{at0034}/items{at0037}']">
<#assign q8_def = copd_assessment_test_entry_def + ".elements['/data{at0001}/events{at0002}/data{at0003}/items{at0074}/items{at0076}']">
<#assign event_time_def = copd_assessment_test_entry_def + ".elements['/data/events/time']">
<#assign q3_def = copd_assessment_test_entry_def + ".elements['/data{at0001}/events{at0002}/data{at0003}/items{at0026}/items{at0018}']">
<#assign q2_def = copd_assessment_test_entry_def + ".elements['/data{at0001}/events{at0002}/data{at0003}/items{at0023}/items{at0011}']">
<#assign q5_ehr_data = copd_assessment_test_entry_ehr_data + "[0].elements['/data{at0001}/events{at0002}/data{at0003}/items{at0044}/items{at0045}']">
<#assign q7_ehr_data = copd_assessment_test_entry_ehr_data + "[0].elements['/data{at0001}/events{at0002}/data{at0003}/items{at0064}/items{at0065}']">
<#assign q6_ehr_data = copd_assessment_test_entry_ehr_data + "[0].elements['/data{at0001}/events{at0002}/data{at0003}/items{at0054}/items{at0055}']">
<#assign total_score_ehr_data = copd_assessment_test_entry_ehr_data + "[0].elements['/data{at0001}/events{at0002}/data{at0003}/items{at0085}']">
<#assign q1_ehr_data = copd_assessment_test_entry_ehr_data + "[0].elements['/data{at0001}/events{at0002}/data{at0003}/items{at0020}/items{at0004}']">
<#assign q4_ehr_data = copd_assessment_test_entry_ehr_data + "[0].elements['/data{at0001}/events{at0002}/data{at0003}/items{at0034}/items{at0037}']">
<#assign q8_ehr_data = copd_assessment_test_entry_ehr_data + "[0].elements['/data{at0001}/events{at0002}/data{at0003}/items{at0074}/items{at0076}']">
<#assign event_time_ehr_data = copd_assessment_test_entry_ehr_data + "[0].elements['/data/events/time']">
<#assign q3_ehr_data = copd_assessment_test_entry_ehr_data + "[0].elements['/data{at0001}/events{at0002}/data{at0003}/items{at0026}/items{at0018}']">
<#assign q2_ehr_data = copd_assessment_test_entry_ehr_data + "[0].elements['/data{at0001}/events{at0002}/data{at0003}/items{at0023}/items{at0011}']">
<#assign q5_cds_data = copd_assessment_test_entry_cds_data + "[0].elements['/data{at0001}/events{at0002}/data{at0003}/items{at0044}/items{at0045}']">
<#assign q7_cds_data = copd_assessment_test_entry_cds_data + "[0].elements['/data{at0001}/events{at0002}/data{at0003}/items{at0064}/items{at0065}']">
<#assign q6_cds_data = copd_assessment_test_entry_cds_data + "[0].elements['/data{at0001}/events{at0002}/data{at0003}/items{at0054}/items{at0055}']">
<#assign total_score_cds_data = copd_assessment_test_entry_cds_data + "[0].elements['/data{at0001}/events{at0002}/data{at0003}/items{at0085}']">
<#assign q1_cds_data = copd_assessment_test_entry_cds_data + "[0].elements['/data{at0001}/events{at0002}/data{at0003}/items{at0020}/items{at0004}']">
<#assign q4_cds_data = copd_assessment_test_entry_cds_data + "[0].elements['/data{at0001}/events{at0002}/data{at0003}/items{at0034}/items{at0037}']">
<#assign q8_cds_data = copd_assessment_test_entry_cds_data + "[0].elements['/data{at0001}/events{at0002}/data{at0003}/items{at0074}/items{at0076}']">
<#assign event_time_cds_data = copd_assessment_test_entry_cds_data + "[0].elements['/data/events/time']">
<#assign q3_cds_data = copd_assessment_test_entry_cds_data + "[0].elements['/data{at0001}/events{at0002}/data{at0003}/items{at0026}/items{at0018}']">
<#assign q2_cds_data = copd_assessment_test_entry_cds_data + "[0].elements['/data{at0001}/events{at0002}/data{at0003}/items{at0023}/items{at0011}']">
<script> 
angular.module('cds_app').controller('COPD_Ctrl', function($scope){
$scope.$on('json_loaded', function(){
  //$scope.${event_time_ehr_data}.value.value = "2016-06-30T00:06:00";
});
$scope.question = {};
$scope.select = function (element, param, val, questionId) {
  element.value.selection = param;
  $scope.execute();
  $scope.question[questionId] = {item: val};
};
});
</script>
  <div ng-show="ready" ng-controller="COPD_Ctrl">
    <div class="content">
    <h1>{{def.concept.name}}</h1>
    <div class="row">
      <div class="medium-12 column"><h3>{{${copd_assessment_test_entry_def}.description}}</h3></div>
    </div>
    <table class="question">
      <tr>
        <td class="wideFix"><div ng-repeat="(key, desc) in ${q1_def}.selections" ng-if="key.charAt(0) == 0">{{desc}}</div></td>
        <td class="widerFix"><div class="centerblock"><div class="circle" ng-repeat="(key, desc) in ${q1_def}.selections" ng-click="select(${q1_ehr_data}, key, $index, 1)" ng-class="{'active' : question[1].item === $index}">{{key.charAt(0)}}</div></div></td>
        <td class="wideFix"><div ng-repeat="(key, desc) in ${q1_def}.selections" ng-if="key.charAt(0) == 5">{{desc}}</div></td>
      </tr>
    </table>
    <table class="question">
      <tr>
        <td class="wideFix"><div ng-repeat="(key, desc) in ${q2_def}.selections" ng-if="key.charAt(0) == 0">{{desc}}</div></td>
        <td class="widerFix"><div class="centerblock"><div class="circle" ng-repeat="(key, desc) in ${q2_def}.selections" ng-click="select(${q2_ehr_data}, key, $index, 2)" ng-class="{'active' : question[2].item === $index}">{{key.charAt(0)}}</div></div></td>
        <td class="wideFix"><div ng-repeat="(key, desc) in ${q2_def}.selections" ng-if="key.charAt(0) == 5">{{desc}}</div></td>
      </tr>
    </table>
    <table class="question">
      <tr>
        <td class="wideFix"><div ng-repeat="(key, desc) in ${q3_def}.selections" ng-if="key.charAt(0) == 0">{{desc}}</div></td>
        <td class="widerFix"><div class="centerblock"><div class="circle" ng-repeat="(key, desc) in ${q3_def}.selections" ng-click="select(${q3_ehr_data}, key, $index, 3)" ng-class="{'active' : question[3].item === $index}">{{key.charAt(0)}}</div></div></td>
        <td class="wideFix"><div ng-repeat="(key, desc) in ${q3_def}.selections" ng-if="key.charAt(0) == 5">{{desc}}</div></td>
      </tr>
    </table>
    <table class="question">
      <tr>
        <td class="wideFix"><div ng-repeat="(key, desc) in ${q4_def}.selections" ng-if="key.charAt(0) == 0">{{desc}}</div></td>
        <td class="widerFix"><div class="centerblock"><div class="circle" ng-repeat="(key, desc) in ${q4_def}.selections" ng-click="select(${q4_ehr_data}, key, $index, 4)" ng-class="{'active' : question[4].item === $index}">{{key.charAt(0)}}</div></div></td>
        <td class="wideFix"><div ng-repeat="(key, desc) in ${q4_def}.selections" ng-if="key.charAt(0) == 5">{{desc}}</div></td>
      </tr>
    </table>
    <table class="question">
      <tr>
        <td class="wideFix"><div ng-repeat="(key, desc) in ${q5_def}.selections" ng-if="key.charAt(0) == 0">{{desc}}</div></td>
        <td class="widerFix"><div class="centerblock"><div class="circle" ng-repeat="(key, desc) in ${q5_def}.selections" ng-click="select(${q5_ehr_data}, key, $index, 5)" ng-class="{'active' : question[5].item === $index}">{{key.charAt(0)}}</div></div></td>
        <td class="wideFix"><div ng-repeat="(key, desc) in ${q5_def}.selections" ng-if="key.charAt(0) == 5">{{desc}}</div></td>
      </tr>
    </table>
    <table class="question">
      <tr>
        <td class="wideFix"><div ng-repeat="(key, desc) in ${q6_def}.selections" ng-if="key.charAt(0) == 0">{{desc}}</div></td>
        <td class="widerFix"><div class="centerblock"><div class="circle" ng-repeat="(key, desc) in ${q6_def}.selections" ng-click="select(${q6_ehr_data}, key, $index, 6)" ng-class="{'active' : question[6].item === $index}">{{key.charAt(0)}}</div></div></td>
        <td class="wideFix"><div ng-repeat="(key, desc) in ${q6_def}.selections" ng-if="key.charAt(0) == 5">{{desc}}</div></td>
      </tr>
    </table>
    <table class="question">
      <tr>
        <td class="wideFix"><div ng-repeat="(key, desc) in ${q7_def}.selections" ng-if="key.charAt(0) == 0">{{desc}}</div></td>
        <td class="widerFix"><div class="centerblock"><div class="circle" ng-repeat="(key, desc) in ${q7_def}.selections" ng-click="select(${q7_ehr_data}, key, $index, 7)" ng-class="{'active' : question[7].item === $index}">{{key.charAt(0)}}</div></div></td>
        <td class="wideFix" ><div ng-repeat="(key, desc) in ${q7_def}.selections" ng-if="key.charAt(0) == 5">{{desc}}</div></td>
      </tr>
    </table>
    <table class="question">
      <tr>
        <td class="wideFix"><div  ng-repeat="(key, desc) in ${q8_def}.selections" ng-if="key.charAt(0) == 0">{{desc}}</div></td>
        <td class="widerFix"><div class="centerblock"><div class="circle" ng-repeat="(key, desc) in ${q8_def}.selections" ng-click="select(${q8_ehr_data}, key, $index, 8)" ng-class="{'active' : question[8].item === $index}">{{key.charAt(0)}}</div></div></td>
        <td class="wideFix" ><div ng-repeat="(key, desc) in ${q8_def}.selections" ng-if="key.charAt(0) == 5">{{desc}}</div></td>
      </tr>
    </table>
    <div class="border"></div>
    <table class="score">
      <tr>
        <td class="wideFix"><h2>{{${total_score_def}.name}}:<div class="tab">{{${total_score_cds_data}.value.magnitude}}</div></h2></td>
      </tr>
    </table>
    </div>
</div>
</body>
<style>
  html, body {
    height: 100%;
    width: 100%;
  }
  body {
    font: 18px/18px 400;
    font-family: sans-serif;
    color: #333;
    background: #ecf0f9;
    -webkit-font-smoothing: antialiased;
    padding: 1em;
  }
  h1 {
    font-weight: 600;
    text-align: center;
  }
  h2 {
    font-weight: 300;
    font-size: 24px;
  }
  h3 {
    font-weight: 300;
    font-size: 18px;
    margin-bottom: 1em;
    font-style: italic;
  }
  .tab {
    display: inline;
    margin-left: 1em;
  }
  .widerFix {
    width: 50%;
  }
  .wideFix {
    width: 25%;
  }
  table.question:nth-child(even) {
    background-color: #f1f1f1;
    border: 1px solid grey;
  }
  table.question:nth-child(odd) {
    background-color: lightsteelblue;
    border: 1px solid darkblue;
  }
  .centerblock {
    display: table;
    margin: auto;
  }
  table.question {
    border-collapse: separate;
    border-radius:  15px;      
    margin-bottom: .5em;
    width: 100%;
  }
  table.score {
    border-collapse: separate;
    border-radius:  15px;      
    width: 100%;
    background-color: lightsteelblue;
    border: 1px solid darkblue;
  }
  .circle {
    width:66px;
    height:66px;
    -moz-border-radius: 50%;
    -webkit-border-radius: 50%;
    border-radius:50%;
    color: black;
    line-height:66px;
    text-align:center;
    background-color: white;
    vertical-align: center;
    float: left;
    cursor: pointer;
  }
  .circle.active, .circle:hover{
    background-color: #dadada;
  }
  .border {
    border-top: 2px solid grey;
    margin-bottom: 0.5em;
  }
  .content {
    padding-bottom: 1em;
  }
</style>
</html>